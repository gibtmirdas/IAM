define("tinymce/spellcheckerplugin/Plugin",["tinymce/spellcheckerplugin/DomTextMatcher","tinymce/PluginManager","tinymce/util/Tools","tinymce/ui/Menu","tinymce/dom/DOMUtils","tinymce/util/JSONRequest","tinymce/util/URI"],function(g,d,c,e,f,b,a){d.add("spellchecker",function(i,k){var m,n=this,z,h,s,w=i.settings;function y(){if(!n.textMatcher){n.textMatcher=new g(i.getBody(),i)}return n.textMatcher}function t(C,A){var B=[];c.each(A,function(D){B.push({selectable:true,text:D.name,data:D.value})});return B}var u=w.spellchecker_languages||"English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv";m=t("Language",c.map(u.split(","),function(A){var B=A.split("=");return{name:B[0],value:B[1]}}));function l(B){for(var A in B){return false}return true}function j(D){var C=[],A=z[D.text];c.each(A,function(H){C.push({text:H,onclick:function(){var I=y().replace(D,H);I.collapse(false);i.selection.setRng(I);v()}})});C.push.apply(C,[{text:"-"},{text:"Ignore",onclick:function(){o(D)}},{text:"Ignore all",onclick:function(){o(D,true)}},{text:"Finish",onclick:r}]);s=new e({items:C,context:"contextmenu",onautohide:function(H){if(H.target.className.indexOf("spellchecker")!=-1){H.preventDefault()}},onhide:function(){s.remove();s=null}});s.renderTo(document.body);var G=y().elementFromMatch(D);var F=f.DOM.getPos(i.getContentAreaContainer());var E=i.dom.getPos(G);var B=i.dom.getRoot();if(B.nodeName=="BODY"){E.x-=B.ownerDocument.documentElement.scrollLeft||B.scrollLeft;E.y-=B.ownerDocument.documentElement.scrollTop||B.scrollTop}else{E.x-=B.scrollLeft;E.y-=B.scrollTop}F.x+=E.x;F.y+=E.y;s.moveTo(F.x,F.y+G.offsetHeight)}function x(){var F=[],D={};if(h){r();return}else{r()}h=true;function A(G){i.setProgressState(false);if(l(G)){i.windowManager.alert("No misspellings found");h=false;return}z=G;y().filter(function(H){return !!G[H.text]}).wrap(function(){return i.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1})});i.fire("SpellcheckStart")}var E=i.getParam("spellchecker_wordchar_pattern")||new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`\u00a7\u00a9\u00ab\u00ae\u00b1\u00b6\u00b7\u00b8\u00bb\u00bc\u00bd\u00be\u00bf\u00d7\u00f7\u00a4\u201d\u201c\u201e]+',"g");y().find(E).each(function(G){var H=G.text;if(!D[H]){if(/^\d+$/.test(H)||H.length==1){return}F.push(H);D[H]=true}});function C(I,H,G){b.sendRPC({url:new a(k).toAbsolute(w.spellchecker_rpc_url),method:I,params:{lang:w.spellchecker_language||"en",words:H},success:function(J){G(J)},error:function(J,K){if(J=="JSON Parse error."){J="Non JSON response:"+K.responseText}else{J="Error: "+J}i.windowManager.alert(J);i.setProgressState(false);r()}})}i.setProgressState(true);var B=w.spellchecker_callback||C;B("spellcheck",F,A);i.focus()}function v(){if(!i.dom.select("span.mce-spellchecker-word").length){r()}}function o(A,B){i.selection.collapse();if(B){y().each(function(C){if(C.text==A.text){y().unwrap(C)}})}else{y().unwrap(A)}v()}function r(){y().reset();n.textMatcher=null;if(h){h=false;i.fire("SpellcheckEnd")}}i.on("click",function(B){if(B.target.className=="mce-spellchecker-word"){B.preventDefault();var A=y().matchFromElement(B.target);i.selection.setRng(y().rangeFromMatch(A));j(A)}});i.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:x,selectable:true,onPostRender:function(){var A=this;i.on("SpellcheckStart SpellcheckEnd",function(){A.active(h)})}});function q(B){var A=w.spellchecker_language;B.control.items().each(function(C){C.active(C.settings.data===A)})}var p={tooltip:"Spellcheck",onclick:x,onPostRender:function(){var A=this;i.on("SpellcheckStart SpellcheckEnd",function(){A.active(h)})}};if(m.length>1){p.type="splitbutton";p.menu=m;p.onshow=q;p.onselect=function(A){w.spellchecker_language=A.control.settings.data}}i.addButton("spellchecker",p);i.addCommand("mceSpellCheck",x);i.on("remove",function(){if(s){s.remove();s=null}});this.getTextMatcher=y;w.spellchecker_language=w.spellchecker_language||w.language||"en"})});