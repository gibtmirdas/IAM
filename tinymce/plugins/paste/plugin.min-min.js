!function(L,w){function E(d,b){for(var f,c=[],a=0;a<d.length;++a){if(f=x[d[a]]||D(d[a]),!f){throw"module definition dependecy not found: "+d[a]}c.push(f)}b.apply(null,c)}function A(c,b,a){if("string"!=typeof c){throw"invalid module definition, module id must be defined and be a string"}if(b===w){throw"invalid module definition, dependencies must be specified"}if(a===w){throw"invalid module definition, definition function must be specified"}E(b,function(){x[c]=a.apply(null,arguments)})}function H(a){return !!x[a]}function D(b){for(var d=L,c=b.split(/[.\/]/),a=0;a<c.length;++a){if(!d[c[a]]){return}d=d[c[a]]}return d}function P(g){for(var e=0;e<g.length;e++){for(var d=L,f=g[e],c=f.split(/[.\/]/),b=0;b<c.length-1;++b){d[c[b]]===w&&(d[c[b]]={}),d=d[c[b]]}d[c[c.length-1]]=x[f]}}var x={},G="tinymce/pasteplugin/Utils",N="tinymce/util/Tools",M="tinymce/html/DomParser",q="tinymce/html/Schema",K="tinymce/pasteplugin/Clipboard",B="tinymce/Env",F="tinymce/util/VK",I="tinymce/pasteplugin/WordFilter",J="tinymce/html/Serializer",k="tinymce/html/Node",j="tinymce/pasteplugin/Quirks",O="tinymce/pasteplugin/Plugin",z="tinymce/PluginManager";A(G,[N,M,q],function(d,b,f){function c(e,g){return d.each(g,function(h){e=h.constructor==RegExp?e.replace(h,""):e.replace(h[0],h[1])}),e}function a(n){function h(l){var i=l.name,o=l;if("br"===i){return void (m+="\n")}if(e[i]&&(m+=" "),u[i]){return void (m+=" ")}if(3==l.type&&(m+=l.value),!l.shortEnded&&(l=l.firstChild)){do{h(l)}while(l=l.next)}p[i]&&o.next&&(m+="\n","p"==i&&(m+="\n"))}var t=new f,g=new b({},t),m="",e=t.getShortEndedElements(),u=d.makeMap("script noscript style textarea video audio iframe object"," "),p=t.getBlockElements();return h(g.parse(n)),m}return{filter:c,innerText:a}}),A(K,[B,F,G],function(b,a,c){return function(S){function X(g){var f,h=S.dom;if(f=S.fire("BeforePastePreProcess",{content:g}),f=S.fire("PastePreProcess",f),g=f.content,!f.isDefaultPrevented()){if(S.hasEventListeners("PastePostProcess")&&!f.isDefaultPrevented()){var d=h.add(S.getBody(),"div",{style:"display:none"},g);f=S.fire("PastePostProcess",{node:d}),h.remove(d),g=f.node.innerHTML}f.isDefaultPrevented()||S.insertContent(g)}}function U(g){g=S.dom.encode(g).replace(/\r\n/g,"\n");var f=S.dom.getParent(S.selection.getStart(),S.dom.isBlock),h=S.settings.forced_root_block,d;h&&(d=S.dom.createHTML(h,S.settings.forced_root_block_attrs),d=d.substr(0,d.length-3)+">"),f&&/^(PRE|DIV)$/.test(f.nodeName)||!h?g=c.filter(g,[[/\n/g,"<br>"]]):(g=c.filter(g,[[/\n\n/g,"</p>"+d],[/^(.*<\/p>)(<p>)$/,d+"$1"],[/\n/g,"<br />"]]),-1!=g.indexOf("<p>")&&(g=d+g)),X(g)}function ae(){var h=S.dom,u=S.getBody(),g=S.dom.getViewPort(S.getWin()),p=g.y,f=20,m;if(n=S.selection.getRng(),S.inline&&(m=S.selection.getScrollContainer(),m&&(p=m.scrollTop)),n.getClientRects){var d=n.getClientRects();if(d.length){f=p+(d[0].top-h.getPos(u).y)}else{f=p;var r=n.startContainer;r&&(3==r.nodeType&&r.parentNode!=u&&(r=r.parentNode),1==r.nodeType&&(f=h.getPos(r,m||u).y))}}Z=h.add(S.getBody(),"div",{id:"mcepastebin",contentEditable:!0,"data-mce-bogus":"1",style:"position: absolute; top: "+f+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},ad),(b.ie||b.gecko)&&h.setStyle(Z,"left","rtl"==h.getStyle(u,"direction",!0)?65535:-65535),h.bind(Z,"beforedeactivate focusin focusout",function(i){i.stopPropagation()}),Z.focus(),S.selection.select(Z,!0)}function Q(){if(Z){for(var d;d=S.dom.get("mcepastebin");){S.dom.remove(d),S.dom.unbind(d)}n&&S.selection.setRng(n)}R=!1,Z=n=null}function W(){var g=ad,f,h;for(f=S.dom.select("div[id=mcepastebin]"),h=f.length;h--;){var d=f[h].innerHTML;g==ad&&(g=""),d.length>g.length&&(g=d)}return g}function ac(h){var f={};if(h&&h.types){var l=h.getData("Text");l&&l.length>0&&(f["text/plain"]=l);for(var g=0;g<h.types.length;g++){var d=h.types[g];f[d]=h.getData(d)}}return f}function ab(d){return ac(d.clipboardData||S.getDoc().dataTransfer)}function t(g,f){function i(m){if("image/png"==h[d].type){var l=new FileReader;return l.onload=function(){X('<img src="'+l.result+'">')},l.readAsDataURL(m.getAsFile()),!0}}if(!(!S.settings.paste_data_images||"text/html" in f||"text/plain" in f)&&g.clipboardData){var h=g.clipboardData.items;if(h){for(var d=0;d<h.length;d++){if(i(h[d])){return !0}}}}}function aa(g){var f=S.getDoc(),h;if(f.caretPositionFromPoint){var d=f.caretPositionFromPoint(g.clientX,g.clientY);h=f.createRange(),h.setStart(d.offsetNode,d.offset),h.collapse(!0)}else{f.caretRangeFromPoint&&(h=f.caretRangeFromPoint(g.clientX,g.clientY))}return h}function T(f,d){return d in f&&f[d].length>0}function V(){S.on("keydown",function(d){if(!d.isDefaultPrevented()&&(a.metaKeyPressed(d)&&86==d.keyCode||d.shiftKey&&45==d.keyCode)){if(R=d.shiftKey&&86==d.keyCode,d.stopImmediatePropagation(),e=(new Date).getTime(),b.ie&&R){return d.preventDefault(),void S.fire("paste",{ieFake:!0})}Q(),ae()}}),S.on("paste",function(g){var i=ab(g),h=(new Date).getTime()-e<1000,d="text"==Y.pasteFormat||R;return g.isDefaultPrevented()?void Q():t(g,i)?void Q():(h||g.preventDefault(),!b.ie||h&&!g.ieFake||(ae(),S.dom.bind(Z,"paste",function(f){f.stopPropagation()}),S.getDoc().execCommand("Paste",!1,null),i["text/html"]=W()),void setTimeout(function(){var f=W();return Z&&Z.firstChild&&"mcepastebin"===Z.firstChild.id&&(d=!0),Q(),!d&&h&&f&&f!=ad&&(i["text/html"]=f),f!=ad&&h||(f=i["text/html"]||i["text/plain"]||ad,f!=ad)?(!T(i,"text/html")&&T(i,"text/plain")&&(d=!0),void (d?U(i["text/plain"]||c.innerText(f)):X(f))):void (h||S.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."))},0))}),S.on("dragstart",function(f){if(f.dataTransfer.types){try{f.dataTransfer.setData("mce-internal",S.selection.getContent())}catch(d){}}}),S.on("drop",function(g){var f=aa(g);if(f&&!g.isDefaultPrevented()){var h=ac(g.dataTransfer),d=h["mce-internal"]||h["text/html"]||h["text/plain"];d&&(g.preventDefault(),S.undoManager.transact(function(){h["mce-internal"]&&S.execCommand("Delete"),S.selection.setRng(f),h["text/html"]?X(d):U(d)}))}})}var Y=this,Z,n,e=0,ad="%MCEPASTEBIN%",R;Y.pasteHtml=X,Y.pasteText=U,S.on("preInit",function(){V(),S.parser.addNodeFilter("img",function(f){if(!S.settings.paste_data_images){for(var g=f.length;g--;){var d=f[g].attributes.map.src;d&&0===d.indexOf("data:image")&&(f[g].attr("data-mce-object")||d===b.transparentSrc||f[g].remove())}}})}),S.on("PreProcess",function(){S.dom.remove(S.dom.get("mcepastebin"))})}}),A(I,[N,M,q,J,k,G],function(h,d,m,g,c,l){function b(a){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(a)||/class="OutlineElement/.test(a)||/id="?docs\-internal\-guid\-/.test(a)}function f(e){var a=e.settings;e.on("BeforePastePreProcess",function(C){function t(U){function Z(ae,ac,ab,ad){var u=ae._listLevel||v;u!=v&&(v>u?y&&(y=y.parent.parent):(p=y,y=null)),y&&y.name==ab?y.append(ae):(p=p||y,y=new c(ab,1),ad>1&&y.attr("start",""+ad),ae.wrap(y)),ae.name="li",ac.value="";var af=ac.next;af&&3==af.type&&(af.value=af.value.replace(/^\u00a0+/,"")),u>v&&p&&p.lastChild.append(y),v=u}for(var y,p,v=1,X=U.getAll("p"),aa=0;aa<X.length;aa++){if(U=X[aa],"p"==U.name&&U.firstChild){for(var T="",W=U.firstChild;W&&!(T=W.value);){W=W.firstChild}if(/^\s*[\u2022\u00b7\u00a7\u00d8\u25CF]\s*$/.test(T)){Z(U,W,"ul");continue}if(/^\s*\w+\.$/.test(T)){var V=/([0-9])\./.exec(T),Y=1;V&&(Y=parseInt(V[1],10)),Z(U,W,"ol",Y);continue}y=null}}}function S(u,T){var v={},y=e.dom.parseStyle(T);if("p"===u.name){var p=/mso-list:\w+ \w+([0-9]+)/.exec(T);p&&(u._listLevel=parseInt(p[1],10))}return h.each(y,function(V,U){switch(U){case"horiz-align":U="text-align";break;case"vert-align":U="vertical-align";break;case"font-color":case"mso-foreground":U="color";break;case"mso-background":case"mso-highlight":U="background";break;case"font-weight":case"font-style":return void ("normal"!=V&&(v[U]=V))}0!==U.indexOf("mso-")&&("all"==i||n&&n[U])&&(v[U]=V)}),/(bold)/i.test(v["font-weight"])&&(delete v["font-weight"],u.wrap(new c("b",1))),/(italic)/i.test(v["font-style"])&&(delete v["font-style"],u.wrap(new c("i",1))),v=e.dom.serializeStyle(v,u.name),v?v:null}var s=C.content,i,n;if(i=a.paste_retain_style_properties,i&&(n=h.makeMap(i.split(/[, ]/))),a.paste_enable_default_filters!==!1&&b(C.content)){C.wordContent=!0,s=l.filter(s,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\xa0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(u,p){return p.length>0?p.replace(/./," ").slice(Math.floor(p.length/2)).split("").join("\xa0"):""}]]);var o=a.paste_word_valid_elements;o||(o="@[style],-strong/b,-em/i,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-table[width],-tr,-td[colspan|rowspan|width],-th,-thead,-tfoot,-tbody,-a[href|name],sub,sup,strike,br");var r=new m({valid_elements:o}),R=new d({},r);R.addAttributeFilter("style",function(u){for(var p=u.length,v;p--;){v=u[p],v.attr("style",S(v,v.attr("style"))),"span"!=v.name||v.attributes.length||v.unwrap()}}),R.addNodeFilter("a",function(y){for(var u=y.length,T,v,p;u--;){T=y[u],v=T.attr("href"),p=T.attr("name"),v&&0===v.indexOf("file://")&&(v=v.split("#")[1],v&&(v="#"+v)),v||p?T.attr({href:v,name:p}):T.unwrap()}});var Q=R.parse(s);t(Q),C.content=new g({},r).serialize(Q)}})}return f.isWordContent=b,f}),A(j,[B,N,I,G],function(c,a,d,b){return function(g){function m(i){g.on("BeforePastePreProcess",function(l){l.content=i(l.content)})}function f(i){return i=b.filter(i,[/^[\s\S]*<!--StartFragment-->|<!--EndFragment-->[\s\S]*$/g,[/<span class="Apple-converted-space">\u00a0<\/span>/g,"\xa0"],/<br>$/i])}function h(l){if(!d.isWordContent(l)){return l}var n=[];a.each(g.schema.getBlockElements(),function(p,o){n.push(o)});var i=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return l=b.filter(l,[[i,"$1"]]),l=b.filter(l,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function e(n){if(d.isWordContent(n)){return n}var i=g.getParam("paste_webkit_styles","color font-size font-family background-color").split(/[, ]/);if(g.settings.paste_remove_styles_if_webkit===!1&&(i="all"),"all"!=i){var l=g.dom,p=g.selection.getNode();n=n.replace(/ style=\"([^\"]+)\"/gi,function(u,v){var r=l.parseStyle(v,"span"),o={};if("none"===i){return""}for(var t=0;t<i.length;t++){l.toHex(l.getStyle(p,i[t],!0))!=r[i[t]]&&(o[i[t]]=r[i[t]])}return o=l.serializeStyle(o,"span"),o?' style="'+o+'"':""})}return n}c.webkit&&(m(e),m(f)),c.ie&&m(h)}}),A(O,[z,K,I,j],function(d,b,f,c){var a;d.add("paste",function(m){function n(){"text"==i.pasteFormat?(this.active(!1),i.pasteFormat="html"):(i.pasteFormat="text",this.active(!0),a||(m.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),a=!0))}var h=this,i,g=m.settings;h.clipboard=i=new b(m),h.quirks=new c(m),h.wordFilter=new f(m),m.settings.paste_as_text&&(h.clipboard.pasteFormat="text"),g.paste_preprocess&&m.on("PastePreProcess",function(l){g.paste_preprocess.call(h,h,l)}),g.paste_postprocess&&m.on("PastePostProcess",function(l){g.paste_postprocess.call(h,h,l)}),m.addCommand("mceInsertClipboardContent",function(o,l){l.content&&h.clipboard.pasteHtml(l.content),l.text&&h.clipboard.pasteText(l.text)}),m.paste_block_drop&&m.on("dragend dragover draggesture dragdrop drop drag",function(l){l.preventDefault(),l.stopPropagation()}),m.settings.paste_data_images||m.on("drop",function(o){var l=o.dataTransfer;l&&l.files&&l.files.length>0&&o.preventDefault()}),m.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:n,active:"text"==h.clipboard.pasteFormat}),m.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:i.pasteFormat,onclick:n})})}),P([G,K,I,j,O])}(this);