define("tinymce/pasteplugin/WordFilter",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema","tinymce/html/Serializer","tinymce/html/Node","tinymce/pasteplugin/Utils"],function(c,h,d,a,b,f){function g(i){return((/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i).test(i)||(/class="OutlineElement/).test(i)||(/id="?docs\-internal\-guid\-/.test(i)))}function e(j){var i=j.settings;j.on("BeforePastePreProcess",function(q){var s=q.content,r,n;r=i.paste_retain_style_properties;if(r){n=c.makeMap(r.split(/[, ]/))}function p(y){var x,D,u=1;function E(H,G,I,K){var J=H._listLevel||u;if(J!=u){if(J<u){if(x){x=x.parent.parent}}else{D=x;x=null}}if(!x||x.name!=I){D=D||x;x=new b(I,1);if(K>1){x.attr("start",""+K)}H.wrap(x)}else{x.append(H)}H.name="li";G.value="";var F=G.next;if(F&&F.type==3){F.value=F.value.replace(/^\u00a0+/,"")}if(J>u&&D){D.lastChild.append(x)}u=J}var C=y.getAll("p");for(var z=0;z<C.length;z++){y=C[z];if(y.name=="p"&&y.firstChild){var B="";var v=y.firstChild;while(v){B=v.value;if(B){break}v=v.firstChild}if(/^\s*[\u2022\u00b7\u00a7\u00d8\u25CF]\s*$/.test(B)){E(y,v,"ul");continue}if(/^\s*\w+\.$/.test(B)){var A=/([0-9])\./.exec(B);var w=1;if(A){w=parseInt(A[1],10)}E(y,v,"ol",w);continue}x=null}}}function k(w,u){var y={},v=j.dom.parseStyle(u);if(w.name==="p"){var x=/mso-list:\w+ \w+([0-9]+)/.exec(u);if(x){w._listLevel=parseInt(x[1],10)}}c.each(v,function(A,z){switch(z){case"horiz-align":z="text-align";break;case"vert-align":z="vertical-align";break;case"font-color":case"mso-foreground":z="color";break;case"mso-background":case"mso-highlight":z="background";break;case"font-weight":case"font-style":if(A!="normal"){y[z]=A}return}if(z.indexOf("mso-")===0){return}if(r=="all"||(n&&n[z])){y[z]=A}});if(/(bold)/i.test(y["font-weight"])){delete y["font-weight"];w.wrap(new b("b",1))}if(/(italic)/i.test(y["font-style"])){delete y["font-style"];w.wrap(new b("i",1))}y=j.dom.serializeStyle(y,w.name);if(y){return y}return null}if(i.paste_enable_default_filters===false){return}if(g(q.content)){q.wordContent=true;s=f.filter(s,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(v,u){return(u.length>0)?u.replace(/./," ").slice(Math.floor(u.length/2)).split("").join("\u00a0"):""}]]);var l=i.paste_word_valid_elements;if(!l){l="@[style],-strong/b,-em/i,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-table[width],-tr,-td[colspan|rowspan|width],-th,-thead,-tfoot,-tbody,-a[href|name],sub,sup,strike,br"}var o=new d({valid_elements:l});var t=new h({},o);t.addAttributeFilter("style",function(u){var v=u.length,w;while(v--){w=u[v];w.attr("style",k(w,w.attr("style")));if(w.name=="span"&&!w.attributes.length){w.unwrap()}}});t.addNodeFilter("a",function(v){var x=v.length,y,u,w;while(x--){y=v[x];u=y.attr("href");w=y.attr("name");if(u&&u.indexOf("file://")===0){u=u.split("#")[1];if(u){u="#"+u}}if(!u&&!w){y.unwrap()}else{y.attr({href:u,name:w})}}});var m=t.parse(s);p(m);q.content=new a({},o).serialize(m)}})}e.isWordContent=g;return e});