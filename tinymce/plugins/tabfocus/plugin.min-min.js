tinymce.PluginManager.add("tabfocus",function(d){function g(h){9!==h.keyCode||h.ctrlKey||h.altKey||h.metaKey||h.preventDefault()}function b(m){function i(s){function o(n){return"BODY"===n.nodeName||"hidden"!=n.type&&"none"!=n.style.display&&"hidden"!=n.style.visibility&&o(n.parentNode)}function p(n){return n.tabIndex||"INPUT"==n.nodeName||"TEXTAREA"==n.nodeName}function q(n){return !p(n)&&"-1"!=n.getAttribute("tabindex")&&o(n)}if(h=a.select(":input:enabled,*[tabindex]:not(iframe)"),f(h,function(u,r){return u.id==d.id?(e=r,!1):void 0}),s>0){for(j=e+1;j<h.length;j++){if(q(h[j])){return h[j]}}}else{for(j=e-1;j>=0;j--){if(q(h[j])){return h[j]}}}return null}var e,h,l,j;if(!(9!==m.keyCode||m.ctrlKey||m.altKey||m.metaKey)&&(l=c(d.getParam("tab_focus",d.getParam("tabfocus_elements",":prev,:next"))),1==l.length&&(l[1]=l[0],l[0]=":prev"),h=m.shiftKey?":prev"==l[0]?i(-1):a.get(l[0]):":next"==l[1]?i(1):a.get(l[1]))){var k=tinymce.get(h.id||h.name);h.id&&k?k.focus():window.setTimeout(function(){tinymce.Env.webkit||window.focus(),h.focus()},10),m.preventDefault()}}var a=tinymce.DOM,f=tinymce.each,c=tinymce.explode;d.on("init",function(){d.inline&&tinymce.DOM.setAttrib(d.getBody(),"tabIndex",null)}),d.on("keyup",g),tinymce.Env.gecko?d.on("keypress keydown",b):d.on("keydown",b)});