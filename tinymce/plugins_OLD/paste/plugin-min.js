(function(b,g){var d={};function c(m,n){var l,j=[];for(var k=0;k<m.length;++k){l=d[m[k]]||e(m[k]);if(!l){throw"module definition dependecy not found: "+m[k]}j.push(l)}n.apply(null,j)}function h(k,j,i){if(typeof k!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(j===g){throw"invalid module definition, dependencies must be specified"}if(i===g){throw"invalid module definition, definition function must be specified"}c(j,function(){d[k]=i.apply(null,arguments)})}function f(i){return !!d[i]}function e(l){var j=b;var i=l.split(/[.\/]/);for(var k=0;k<i.length;++k){if(!j[i[k]]){return}j=j[i[k]]}return j}function a(l){for(var k=0;k<l.length;k++){var m=b;var o=l[k];var j=o.split(/[.\/]/);for(var n=0;n<j.length-1;++n){if(m[j[n]]===g){m[j[n]]={}}m=m[j[n]]}m[j[j.length-1]]=d[o]}}h("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(i,m,k){function j(o,n){i.each(n,function(p){if(p.constructor==RegExp){o=o.replace(p,"")}else{o=o.replace(p[0],p[1])}});return o}function l(q){var s=new k(),u=new m({},s),t="";var p=s.getShortEndedElements();var o=i.makeMap("script noscript style textarea video audio iframe object"," ");var r=s.getBlockElements();function n(x){var v=x.name,w=x;if(v==="br"){t+="\n";return}if(p[v]){t+=" "}if(o[v]){t+=" ";return}if(x.type==3){t+=x.value}if(!x.shortEnded){if((x=x.firstChild)){do{n(x)}while((x=x.next))}}if(r[v]&&w.next){t+="\n";if(v=="p"){t+="\n"}}}n(u.parse(q));return t}return{filter:j,innerText:l}});h("tinymce/pasteplugin/Clipboard",["tinymce/Env","tinymce/util/VK","tinymce/pasteplugin/Utils"],function(i,k,j){return function(p){var w=this,n,z,m=0;var q="%MCEPASTEBIN%",A;function x(F){var E,G=p.dom;E=p.fire("BeforePastePreProcess",{content:F});E=p.fire("PastePreProcess",E);F=E.content;if(!E.isDefaultPrevented()){if(p.hasEventListeners("PastePostProcess")&&!E.isDefaultPrevented()){var D=G.add(p.getBody(),"div",{style:"display:none"},F);E=p.fire("PastePostProcess",{node:D});G.remove(D);F=E.node.innerHTML}if(!E.isDefaultPrevented()){p.insertContent(F)}}}function y(G){G=p.dom.encode(G).replace(/\r\n/g,"\n");var E=p.dom.getParent(p.selection.getStart(),p.dom.isBlock);var D=p.settings.forced_root_block;var F;if(D){F=p.dom.createHTML(D,p.settings.forced_root_block_attrs);F=F.substr(0,F.length-3)+">"}if((E&&/^(PRE|DIV)$/.test(E.nodeName))||!D){G=j.filter(G,[[/\n/g,"<br>"]])}else{G=j.filter(G,[[/\n\n/g,"</p>"+F],[/^(.*<\/p>)(<p>)$/,F+"$1"],[/\n/g,"<br />"]]);if(G.indexOf("<p>")!=-1){G=F+G}}x(G)}function r(){var K=p.dom,E=p.getBody();var D=p.dom.getViewPort(p.getWin()),J=D.y,I=20;var H;z=p.selection.getRng();if(p.inline){H=p.selection.getScrollContainer();if(H){J=H.scrollTop}}if(z.getClientRects){var G=z.getClientRects();if(G.length){I=J+(G[0].top-K.getPos(E).y)}else{I=J;var F=z.startContainer;if(F){if(F.nodeType==3&&F.parentNode!=E){F=F.parentNode}if(F.nodeType==1){I=K.getPos(F,H||E).y}}}}n=K.add(p.getBody(),"div",{id:"mcepastebin",contentEditable:true,"data-mce-bogus":"1",style:"position: absolute; top: "+I+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},q);if(i.ie||i.gecko){K.setStyle(n,"left",K.getStyle(E,"direction",true)=="rtl"?65535:-65535)}K.bind(n,"beforedeactivate focusin focusout",function(L){L.stopPropagation()});n.focus();p.selection.select(n,true)}function C(){if(n){var D;while((D=p.dom.get("mcepastebin"))){p.dom.remove(D);p.dom.unbind(D)}if(z){p.selection.setRng(z)}}A=false;n=z=null}function B(){var G=q,E,F;E=p.dom.select("div[id=mcepastebin]");F=E.length;while(F--){var D=E[F].innerHTML;if(G==q){G=""}if(D.length>G.length){G=D}}return G}function t(F){var E={};if(F&&F.types){var H=F.getData("Text");if(H&&H.length>0){E["text/plain"]=H}for(var D=0;D<F.types.length;D++){var G=F.types[D];E[G]=F.getData(G)}}return E}function u(D){return t(D.clipboardData||p.getDoc().dataTransfer)}function s(H,G){function F(J){if(D[E].type=="image/png"){var I=new FileReader();I.onload=function(){x('<img src="'+I.result+'">')};I.readAsDataURL(J.getAsFile());return true}}if(!p.settings.paste_data_images||"text/html" in G||"text/plain" in G){return}if(H.clipboardData){var D=H.clipboardData.items;if(D){for(var E=0;E<D.length;E++){if(F(D[E])){return true}}}}}function l(G){var F=p.getDoc(),E;if(F.caretPositionFromPoint){var D=F.caretPositionFromPoint(G.clientX,G.clientY);E=F.createRange();E.setStart(D.offsetNode,D.offset);E.collapse(true)}else{if(F.caretRangeFromPoint){E=F.caretRangeFromPoint(G.clientX,G.clientY)}}return E}function v(D,E){return E in D&&D[E].length>0}function o(){p.on("keydown",function(D){if(D.isDefaultPrevented()){return}if((k.metaKeyPressed(D)&&D.keyCode==86)||(D.shiftKey&&D.keyCode==45)){A=D.shiftKey&&D.keyCode==86;D.stopImmediatePropagation();m=new Date().getTime();if(i.ie&&A){D.preventDefault();p.fire("paste",{ieFake:true});return}C();r()}});p.on("paste",function(G){var F=u(G);var D=new Date().getTime()-m<1000;var E=w.pasteFormat=="text"||A;if(G.isDefaultPrevented()){C();return}if(s(G,F)){C();return}if(!D){G.preventDefault()}if(i.ie&&(!D||G.ieFake)){r();p.dom.bind(n,"paste",function(H){H.stopPropagation()});p.getDoc().execCommand("Paste",false,null);F["text/html"]=B()}setTimeout(function(){var H=B();if(n&&n.firstChild&&n.firstChild.id==="mcepastebin"){E=true}C();if(!E&&D&&H&&H!=q){F["text/html"]=H}if(H==q||!D){H=F["text/html"]||F["text/plain"]||q;if(H==q){if(!D){p.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")}return}}if(!v(F,"text/html")&&v(F,"text/plain")){E=true}if(E){y(F["text/plain"]||j.innerText(H))}else{x(H)}},0)});p.on("dragstart",function(E){if(E.dataTransfer.types){try{E.dataTransfer.setData("mce-internal",p.selection.getContent())}catch(D){}}});p.on("drop",function(G){var D=l(G);if(D&&!G.isDefaultPrevented()){var E=t(G.dataTransfer);var F=E["mce-internal"]||E["text/html"]||E["text/plain"];if(F){G.preventDefault();p.undoManager.transact(function(){if(E["mce-internal"]){p.execCommand("Delete")}p.selection.setRng(D);if(!E["text/html"]){y(F)}else{x(F)}})}}})}w.pasteHtml=x;w.pasteText=y;p.on("preInit",function(){o();p.parser.addNodeFilter("img",function(D){if(!p.settings.paste_data_images){var E=D.length;while(E--){var F=D[E].attributes.map.src;if(F&&F.indexOf("data:image")===0){if(!D[E].attr("data-mce-object")&&F!==i.transparentSrc){D[E].remove()}}}}})});p.on("PreProcess",function(){p.dom.remove(p.dom.get("mcepastebin"))})}});h("tinymce/pasteplugin/WordFilter",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema","tinymce/html/Serializer","tinymce/html/Node","tinymce/pasteplugin/Utils"],function(k,p,l,i,j,n){function o(q){return((/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i).test(q)||(/class="OutlineElement/).test(q)||(/id="?docs\-internal\-guid\-/.test(q)))}function m(r){var q=r.settings;r.on("BeforePastePreProcess",function(y){var A=y.content,z,v;z=q.paste_retain_style_properties;if(z){v=k.makeMap(z.split(/[, ]/))}function x(G){var F,L,C=1;function M(P,O,Q,S){var R=P._listLevel||C;if(R!=C){if(R<C){if(F){F=F.parent.parent}}else{L=F;F=null}}if(!F||F.name!=Q){L=L||F;F=new j(Q,1);if(S>1){F.attr("start",""+S)}P.wrap(F)}else{F.append(P)}P.name="li";O.value="";var N=O.next;if(N&&N.type==3){N.value=N.value.replace(/^\u00a0+/,"")}if(R>C&&L){L.lastChild.append(F)}C=R}var K=G.getAll("p");for(var H=0;H<K.length;H++){G=K[H];if(G.name=="p"&&G.firstChild){var J="";var D=G.firstChild;while(D){J=D.value;if(J){break}D=D.firstChild}if(/^\s*[\u2022\u00b7\u00a7\u00d8\u25CF]\s*$/.test(J)){M(G,D,"ul");continue}if(/^\s*\w+\.$/.test(J)){var I=/([0-9])\./.exec(J);var E=1;if(I){E=parseInt(I[1],10)}M(G,D,"ol",E);continue}F=null}}}function s(E,C){var G={},D=r.dom.parseStyle(C);if(E.name==="p"){var F=/mso-list:\w+ \w+([0-9]+)/.exec(C);if(F){E._listLevel=parseInt(F[1],10)}}k.each(D,function(I,H){switch(H){case"horiz-align":H="text-align";break;case"vert-align":H="vertical-align";break;case"font-color":case"mso-foreground":H="color";break;case"mso-background":case"mso-highlight":H="background";break;case"font-weight":case"font-style":if(I!="normal"){G[H]=I}return}if(H.indexOf("mso-")===0){return}if(z=="all"||(v&&v[H])){G[H]=I}});if(/(bold)/i.test(G["font-weight"])){delete G["font-weight"];E.wrap(new j("b",1))}if(/(italic)/i.test(G["font-style"])){delete G["font-style"];E.wrap(new j("i",1))}G=r.dom.serializeStyle(G,E.name);if(G){return G}return null}if(q.paste_enable_default_filters===false){return}if(o(y.content)){y.wordContent=true;A=n.filter(A,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(D,C){return(C.length>0)?C.replace(/./," ").slice(Math.floor(C.length/2)).split("").join("\u00a0"):""}]]);var t=q.paste_word_valid_elements;if(!t){t="@[style],-strong/b,-em/i,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-table[width],-tr,-td[colspan|rowspan|width],-th,-thead,-tfoot,-tbody,-a[href|name],sub,sup,strike,br"}var w=new l({valid_elements:t});var B=new p({},w);B.addAttributeFilter("style",function(C){var D=C.length,E;while(D--){E=C[D];E.attr("style",s(E,E.attr("style")));if(E.name=="span"&&!E.attributes.length){E.unwrap()}}});B.addNodeFilter("a",function(D){var F=D.length,G,C,E;while(F--){G=D[F];C=G.attr("href");E=G.attr("name");if(C&&C.indexOf("file://")===0){C=C.split("#")[1];if(C){C="#"+C}}if(!C&&!E){G.unwrap()}else{G.attr({href:C,name:E})}}});var u=B.parse(A);x(u);y.content=new i({},w).serialize(u)}})}m.isWordContent=o;return m});h("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(i,j,l,k){return function(o){function q(r){o.on("BeforePastePreProcess",function(s){s.content=r(s.content)})}function p(r){r=k.filter(r,[/^[\s\S]*<!--StartFragment-->|<!--EndFragment-->[\s\S]*$/g,[/<span class="Apple-converted-space">\u00a0<\/span>/g,"\u00a0"],/<br>$/i]);return r}function n(r){if(!l.isWordContent(r)){return r}var s=[];j.each(o.schema.getBlockElements(),function(v,u){s.push(u)});var t=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+s.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");r=k.filter(r,[[t,"$1"]]);r=k.filter(r,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]]);return r}function m(t){if(l.isWordContent(t)){return t}var r=o.getParam("paste_webkit_styles","color font-size font-family background-color").split(/[, ]/);if(o.settings.paste_remove_styles_if_webkit===false){r="all"}if(r!="all"){var u=o.dom,s=o.selection.getNode();t=t.replace(/ style=\"([^\"]+)\"/gi,function(w,y){var v=u.parseStyle(y,"span"),z={};if(r==="none"){return""}for(var x=0;x<r.length;x++){if(u.toHex(u.getStyle(s,r[x],true))!=v[r[x]]){z[r[x]]=v[r[x]]}}z=u.serializeStyle(z,"span");if(z){return' style="'+z+'"'}return""})}return t}if(i.webkit){q(m);q(p)}if(i.ie){q(n)}}});h("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(i,m,l,j){var k;i.add("paste",function(q){var o=this,r,p=q.settings;function n(){if(r.pasteFormat=="text"){this.active(false);r.pasteFormat="html"}else{r.pasteFormat="text";this.active(true);if(!k){q.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.");k=true}}}o.clipboard=r=new m(q);o.quirks=new j(q);o.wordFilter=new l(q);if(q.settings.paste_as_text){o.clipboard.pasteFormat="text"}if(p.paste_preprocess){q.on("PastePreProcess",function(s){p.paste_preprocess.call(o,o,s)})}if(p.paste_postprocess){q.on("PastePostProcess",function(s){p.paste_postprocess.call(o,o,s)})}q.addCommand("mceInsertClipboardContent",function(t,s){if(s.content){o.clipboard.pasteHtml(s.content)}if(s.text){o.clipboard.pasteText(s.text)}});if(q.paste_block_drop){q.on("dragend dragover draggesture dragdrop drop drag",function(s){s.preventDefault();s.stopPropagation()})}if(!q.settings.paste_data_images){q.on("drop",function(t){var s=t.dataTransfer;if(s&&s.files&&s.files.length>0){t.preventDefault()}})}q.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:n,active:o.clipboard.pasteFormat=="text"});q.addMenuItem("pastetext",{text:"Paste as text",selectable:true,active:r.pasteFormat,onclick:n})})});a(["tinymce/pasteplugin/Utils","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks","tinymce/pasteplugin/Plugin"])})(this);