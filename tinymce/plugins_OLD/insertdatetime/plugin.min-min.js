tinymce.PluginManager.add("insertdatetime",function(j){function q(d,c){function e(n,m){if(n=""+n,n.length<m){for(var i=0;i<m-n.length;i++){n="0"+n}}return n}return c=c||new Date,d=d.replace("%D","%m/%d/%Y"),d=d.replace("%r","%I:%M:%S %p"),d=d.replace("%Y",""+c.getFullYear()),d=d.replace("%y",""+c.getYear()),d=d.replace("%m",e(c.getMonth()+1,2)),d=d.replace("%d",e(c.getDate(),2)),d=d.replace("%H",""+e(c.getHours(),2)),d=d.replace("%M",""+e(c.getMinutes(),2)),d=d.replace("%S",""+e(c.getSeconds(),2)),d=d.replace("%I",""+((c.getHours()+11)%12+1)),d=d.replace("%p",""+(c.getHours()<12?"AM":"PM")),d=d.replace("%B",""+j.translate(g[c.getMonth()])),d=d.replace("%b",""+j.translate(l[c.getMonth()])),d=d.replace("%A",""+j.translate(k[c.getDay()])),d=d.replace("%a",""+j.translate(h[c.getDay()])),d=d.replace("%%","%")}function o(c){var m=q(c);if(j.settings.insertdatetime_element){var e;e=q(/%[HMSIp]/.test(c)?"%Y-%m-%dT%H:%M":"%Y-%m-%d"),m='<time datetime="'+e+'">'+m+"</time>";var d=j.dom.getParent(j.selection.getStart(),"time");if(d){return void j.dom.setOuterHTML(d,m)}}j.insertContent(m)}var f,b,h="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),k="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),l="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),g="January February March April May June July August September October November December".split(" "),p=[];j.addCommand("mceInsertDate",function(){o(j.getParam("insertdatetime_dateformat",j.translate("%Y-%m-%d")))}),j.addCommand("mceInsertTime",function(){o(j.getParam("insertdatetime_timeformat",j.translate("%H:%M:%S")))}),j.addButton("insertdatetime",{type:"splitbutton",title:"Insert date/time",onclick:function(){o(f||b)},menu:p}),tinymce.each(j.settings.insertdatetime_formats||["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"],function(a){b||(b=a),p.push({text:q(a),onclick:function(){f=a,o(a)}})}),j.addMenuItem("insertdatetime",{icon:"date",text:"Insert date/time",menu:p,context:"insert"})});