define("tinymce/tableplugin/Plugin",["tinymce/tableplugin/TableGrid","tinymce/tableplugin/Quirks","tinymce/tableplugin/CellSelection","tinymce/util/Tools","tinymce/dom/TreeWalker","tinymce/Env","tinymce/PluginManager"],function(h,g,i,a,f,c,b){var e=a.each;function d(l){var j,y,u=this;function o(C){return C?C.replace(/px$/,""):""}function v(C){if(/^[0-9]+$/.test(C)){C+="px"}return C}function B(C){e("left center right".split(" "),function(D){l.formatter.remove("align"+D,{},C)})}function k(){var G=l.dom,C,E,D,F;C=G.getParent(l.selection.getStart(),"table");F={width:o(G.getStyle(C,"width")||G.getAttrib(C,"width")),height:o(G.getStyle(C,"height")||G.getAttrib(C,"height")),cellspacing:C?G.getAttrib(C,"cellspacing"):"",cellpadding:C?G.getAttrib(C,"cellpadding"):"",border:C?G.getAttrib(C,"border"):"",caption:!!G.select("caption",C)[0]};e("left center right".split(" "),function(H){if(l.formatter.matchNode(C,"align"+H)){F.align=H}});if(!C){E={label:"Cols",name:"cols"};D={label:"Rows",name:"rows"}}l.windowManager.open({title:"Table properties",items:{type:"form",layout:"grid",columns:2,data:F,defaults:{type:"textbox",maxWidth:50},items:[E,D,{label:"Width",name:"width"},{label:"Height",name:"height"},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"},{label:"Alignment",minWidth:90,name:"align",type:"listbox",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]},onsubmit:function(){var I=this.toJSON(),H;l.undoManager.transact(function(){if(!C){C=s(I.cols||1,I.rows||1)}l.dom.setAttribs(C,{cellspacing:I.cellspacing,cellpadding:I.cellpadding,border:I.border});l.dom.setStyles(C,{width:v(I.width),height:v(I.height)});H=G.select("caption",C)[0];if(H&&!I.caption){G.remove(H)}if(!H&&I.caption){H=G.create("caption");H.innerHTML=!c.ie?'<br data-mce-bogus="1"/>':"\u00a0";C.insertBefore(H,C.firstChild)}B(C);if(I.align){l.formatter.apply("align"+I.align,{},C)}l.focus();l.addVisual()})}})}function w(D,C){l.windowManager.open({title:"Merge cells",body:[{label:"Cols",name:"cols",type:"textbox",size:10},{label:"Rows",name:"rows",type:"textbox",size:10}],onsubmit:function(){var E=this.toJSON();l.undoManager.transact(function(){D.merge(C,E.cols,E.rows)})}})}function n(){var F=l.dom,D,E,C=[];C=l.dom.select("td.mce-item-selected,th.mce-item-selected");D=l.dom.getParent(l.selection.getStart(),"td,th");if(!C.length&&D){C.push(D)}D=D||C[0];if(!D){return}E={width:o(F.getStyle(D,"width")||F.getAttrib(D,"width")),height:o(F.getStyle(D,"height")||F.getAttrib(D,"height")),scope:F.getAttrib(D,"scope")};E.type=D.nodeName.toLowerCase();e("left center right".split(" "),function(G){if(l.formatter.matchNode(D,"align"+G)){E.align=G}});l.windowManager.open({title:"Cell properties",items:{type:"form",data:E,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width"},{label:"Height",name:"height"},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"Alignment",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]},onsubmit:function(){var G=this.toJSON();l.undoManager.transact(function(){e(C,function(H){l.dom.setAttrib(H,"scope",G.scope);l.dom.setStyles(H,{width:v(G.width),height:v(G.height)});if(G.type&&H.nodeName.toLowerCase()!=G.type){H=F.rename(H,G.type)}B(H);if(G.align){l.formatter.apply("align"+G.align,{},H)}});l.focus()})}})}function p(){var H=l.dom,C,E,D,G,F=[];C=l.dom.getParent(l.selection.getStart(),"table");E=l.dom.getParent(l.selection.getStart(),"td,th");e(C.rows,function(I){e(I.cells,function(J){if(H.hasClass(J,"mce-item-selected")||J==E){F.push(I);return false}})});D=F[0];if(!D){return}G={height:o(H.getStyle(D,"height")||H.getAttrib(D,"height")),scope:H.getAttrib(D,"scope")};G.type=D.parentNode.nodeName.toLowerCase();e("left center right".split(" "),function(I){if(l.formatter.matchNode(D,"align"+I)){G.align=I}});l.windowManager.open({title:"Row properties",items:{type:"form",data:G,columns:2,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"None",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"}]},onsubmit:function(){var K=this.toJSON(),I,J,L;l.undoManager.transact(function(){var M=K.type;e(F,function(N){l.dom.setAttrib(N,"scope",K.scope);l.dom.setStyles(N,{height:v(K.height)});if(M!=N.parentNode.nodeName.toLowerCase()){I=H.getParent(N,"table");J=N.parentNode;L=H.select(M,I)[0];if(!L){L=H.create(M);if(I.firstChild){I.insertBefore(L,I.firstChild)}else{I.appendChild(L)}}L.appendChild(N);if(!J.hasChildNodes()){H.remove(J)}}B(N);if(K.align){l.formatter.apply("align"+K.align,{},N)}});l.focus()})}})}function x(C){return function(){l.execCommand(C)}}function s(G,F){var H,C,E;E='<table id="__mce"><tbody>';for(H=0;H<F;H++){E+="<tr>";for(C=0;C<G;C++){E+="<td>"+(c.ie?" ":"<br>")+"</td>"}E+="</tr>"}E+="</tbody></table>";l.insertContent(E);var D=l.dom.get("__mce");l.dom.setAttrib(D,"id",null);return D}function z(D,C){function E(){D.disabled(!l.dom.getParent(l.selection.getStart(),C));l.selection.selectorChanged(C,function(F){D.disabled(!F)})}if(l.initialized){E()}else{l.on("init",E)}}function t(){z(this,"table")}function r(){z(this,"td,th")}function m(){var D="";D='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var E=0;E<10;E++){D+="<tr>";for(var C=0;C<10;C++){D+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(E*10+C)+'" href="#" data-mce-x="'+C+'" data-mce-y="'+E+'" '+(C+E===0?' class="mce-active"':"")+"></a></td>"}D+="</tr>"}D+="</table>";D+='<div class="mce-text-center" role="presentation">1 x 1</div>';return D}function q(E,C,D){var I=D.getEl().getElementsByTagName("table")[0];var K=D.parent().rel,G,F,J,H;if(D.isRtl()||K=="tl-tr"){for(F=9;F>=0;F--){for(G=0;G<10;G++){H=I.rows[F].childNodes[G].firstChild;l.dom.toggleClass(H,"mce-active",G>=E&&F<=C);if(G>=E&&F<=C){J=H}}}E=9-E;I.nextSibling.innerHTML=E+" x "+(C+1)}else{for(F=0;F<10;F++){for(G=0;G<10;G++){H=I.rows[F].childNodes[G].firstChild;l.dom.toggleClass(H,"mce-active",G<=E&&F<=C);if(G<=E&&F<=C){J=H}}}I.nextSibling.innerHTML=(E+1)+" x "+(C+1)}return J.parentNode}if(l.settings.table_grid===false){l.addMenuItem("inserttable",{text:"Insert table",icon:"table",context:"table",onclick:k})}else{l.addMenuItem("inserttable",{text:"Insert table",icon:"table",context:"table",ariaHideMenu:true,onclick:function(C){if(C.aria){this.parent().hideAll();C.stopImmediatePropagation();k()}},onhide:function(){var C=this.menu.items()[0].getEl().getElementsByTagName("a");l.dom.removeClass(C,"mce-active");l.dom.addClass(C[0],"mce-active")},menu:[{type:"container",html:m(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(E){var D=E.target,C,F;if(D.tagName.toUpperCase()=="A"){C=parseInt(D.getAttribute("data-mce-x"),10);F=parseInt(D.getAttribute("data-mce-y"),10);if(C!==this.lastX||F!==this.lastY){q(C,F,E.control);this.lastX=C;this.lastY=F}}},onkeydown:function(E){var C=this.lastX,F=this.lastY,D;switch(E.keyCode){case 37:if(C>0){C--;D=true}break;case 39:D=true;if(C<9){C++}break;case 38:D=true;if(F>0){F--}break;case 40:D=true;if(F<9){F++}break}if(D){E.preventDefault();E.stopPropagation();q(C,F,E.control).focus();this.lastX=C;this.lastY=F}},onclick:function(C){if(C.target.tagName.toUpperCase()=="A"){C.preventDefault();C.stopPropagation();this.parent().cancel();s(this.lastX+1,this.lastY+1)}}}]})}l.addMenuItem("tableprops",{text:"Table properties",context:"table",onPostRender:t,onclick:k});l.addMenuItem("deletetable",{text:"Delete table",context:"table",onPostRender:t,cmd:"mceTableDelete"});l.addMenuItem("cell",{separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:x("mceTableCellProps"),onPostRender:r},{text:"Merge cells",onclick:x("mceTableMergeCells"),onPostRender:r},{text:"Split cell",onclick:x("mceTableSplitCells"),onPostRender:r}]});l.addMenuItem("row",{text:"Row",context:"table",menu:[{text:"Insert row before",onclick:x("mceTableInsertRowBefore"),onPostRender:r},{text:"Insert row after",onclick:x("mceTableInsertRowAfter"),onPostRender:r},{text:"Delete row",onclick:x("mceTableDeleteRow"),onPostRender:r},{text:"Row properties",onclick:x("mceTableRowProps"),onPostRender:r},{text:"-"},{text:"Cut row",onclick:x("mceTableCutRow"),onPostRender:r},{text:"Copy row",onclick:x("mceTableCopyRow"),onPostRender:r},{text:"Paste row before",onclick:x("mceTablePasteRowBefore"),onPostRender:r},{text:"Paste row after",onclick:x("mceTablePasteRowAfter"),onPostRender:r}]});l.addMenuItem("column",{text:"Column",context:"table",menu:[{text:"Insert column before",onclick:x("mceTableInsertColBefore"),onPostRender:r},{text:"Insert column after",onclick:x("mceTableInsertColAfter"),onPostRender:r},{text:"Delete column",onclick:x("mceTableDeleteCol"),onPostRender:r}]});var A=[];e("inserttable tableprops deletetable | cell row column".split(" "),function(C){if(C=="|"){A.push({text:"-"})}else{A.push(l.menuItems[C])}});l.addButton("table",{type:"menubutton",title:"Table",menu:A});if(!c.isIE){l.on("click",function(C){C=C.target;if(C.nodeName==="TABLE"){l.selection.select(C);l.nodeChanged()}})}u.quirks=new g(l);l.on("Init",function(){j=l.windowManager;u.cellSelection=new i(l)});e({mceTableSplitCells:function(C){C.split()},mceTableMergeCells:function(D){var E,F,C;C=l.dom.getParent(l.selection.getStart(),"th,td");if(C){E=C.rowSpan;F=C.colSpan}if(!l.dom.select("td.mce-item-selected,th.mce-item-selected").length){w(D,C)}else{D.merge()}},mceTableInsertRowBefore:function(C){C.insertRow(true)},mceTableInsertRowAfter:function(C){C.insertRow()},mceTableInsertColBefore:function(C){C.insertCol(true)},mceTableInsertColAfter:function(C){C.insertCol()},mceTableDeleteCol:function(C){C.deleteCols()},mceTableDeleteRow:function(C){C.deleteRows()},mceTableCutRow:function(C){y=C.cutRows()},mceTableCopyRow:function(C){y=C.copyRows()},mceTablePasteRowBefore:function(C){C.pasteRows(y,true)},mceTablePasteRowAfter:function(C){C.pasteRows(y)},mceTableDelete:function(C){C.deleteTable()}},function(D,C){l.addCommand(C,function(){var E=new h(l);if(E){D(E);l.execCommand("mceRepaint");u.cellSelection.clear()}})});e({mceInsertTable:function(){k()},mceTableRowProps:p,mceTableCellProps:n},function(D,C){l.addCommand(C,function(E,F){D(F)})})}b.add("table",d)});