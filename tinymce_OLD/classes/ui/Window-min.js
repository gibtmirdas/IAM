define("tinymce/ui/Window",["tinymce/ui/FloatPanel","tinymce/ui/Panel","tinymce/ui/DomUtils","tinymce/ui/DragHelper"],function(e,d,a,c){var b=e.extend({modal:true,Defaults:{border:1,layout:"flex",containerCls:"panel",role:"dialog",callbacks:{submit:function(){this.fire("submit",{data:this.toJSON()})},close:function(){this.close()}}},init:function(g){var f=this;f._super(g);if(f.isRtl()){f.addClass("rtl")}f.addClass("window");f._fixed=true;if(g.buttons){f.statusbar=new d({layout:"flex",border:"1 0 0 0",spacing:3,padding:10,align:"center",pack:f.isRtl()?"start":"end",defaults:{type:"button"},items:g.buttons});f.statusbar.addClass("foot");f.statusbar.parent(f)}f.on("click",function(h){if(h.target.className.indexOf(f.classPrefix+"close")!=-1){f.close()}});f.on("cancel",function(){f.close()});f.aria("describedby",f.describedBy||f._id+"-none");f.aria("label",g.title);f._fullscreen=false},recalc:function(){var g=this,j=g.statusbar,i,h,f,k;if(g._fullscreen){g.layoutRect(a.getWindowSize());g.layoutRect().contentH=g.layoutRect().innerH}g._super();i=g.layoutRect();if(g.settings.title&&!g._fullscreen){h=i.headerW;if(h>i.w){f=i.x-Math.max(0,h/2);g.layoutRect({w:h,x:f});k=true}}if(j){j.layoutRect({w:g.layoutRect().innerW}).recalc();h=j.layoutRect().minW+i.deltaW;if(h>i.w){f=i.x-Math.max(0,h-i.w);g.layoutRect({w:h,x:f});k=true}}if(k){g.recalc()}},initLayoutRect:function(){var f=this,j=f._super(),i=0,k;if(f.settings.title&&!f._fullscreen){k=f.getEl("head");var g=a.getSize(k);j.headerW=g.width;j.headerH=g.height;i+=j.headerH}if(f.statusbar){i+=f.statusbar.layoutRect().h}j.deltaH+=i;j.minH+=i;j.h+=i;var h=a.getWindowSize();j.x=Math.max(0,h.w/2-j.w/2);j.y=Math.max(0,h.h/2-j.h/2);return j},renderHtml:function(){var g=this,j=g._layout,m=g._id,k=g.classPrefix;var i=g.settings,f="",l="",h=i.html;g.preRender();j.preRender(g);if(i.title){f=('<div id="'+m+'-head" class="'+k+'window-head"><div id="'+m+'-title" class="'+k+'title">'+g.encode(i.title)+'</div><button type="button" class="'+k+'close" aria-hidden="true">\u00d7</button><div id="'+m+'-dragh" class="'+k+'dragh"></div></div>')}if(i.url){h='<iframe src="'+i.url+'" tabindex="-1"></iframe>'}if(typeof(h)=="undefined"){h=j.renderHtml(g)}if(g.statusbar){l=g.statusbar.renderHtml()}return('<div id="'+m+'" class="'+g.classes()+'" hidefocus="1"><div class="'+g.classPrefix+'reset" role="application">'+f+'<div id="'+m+'-body" class="'+g.classes("body")+'">'+h+"</div>"+l+"</div></div>")},fullscreen:function(l){var f=this,k=document.documentElement,g,j=f.classPrefix,i;if(l!=f._fullscreen){a.on(window,"resize",function(){var n;if(f._fullscreen){if(!g){n=new Date().getTime();var m=a.getWindowSize();f.moveTo(0,0).resizeTo(m.w,m.h);if((new Date().getTime())-n>50){g=true}}else{if(!f._timer){f._timer=setTimeout(function(){var o=a.getWindowSize();f.moveTo(0,0).resizeTo(o.w,o.h);f._timer=0},50)}}}});i=f.layoutRect();f._fullscreen=l;if(!l){f._borderBox=f.parseBox(f.settings.border);f.getEl("head").style.display="";i.deltaH+=i.headerH;a.removeClass(k,j+"fullscreen");a.removeClass(document.body,j+"fullscreen");f.removeClass("fullscreen");f.moveTo(f._initial.x,f._initial.y).resizeTo(f._initial.w,f._initial.h)}else{f._initial={x:i.x,y:i.y,w:i.w,h:i.h};f._borderBox=f.parseBox("0");f.getEl("head").style.display="none";i.deltaH-=i.headerH+2;a.addClass(k,j+"fullscreen");a.addClass(document.body,j+"fullscreen");f.addClass("fullscreen");var h=a.getWindowSize();f.moveTo(0,0).resizeTo(h.w,h.h)}}return f.reflow()},postRender:function(){var f=this,g;setTimeout(function(){f.addClass("in")},0);f._super();if(f.statusbar){f.statusbar.postRender()}f.focus();this.dragHelper=new c(f._id+"-dragh",{start:function(){g={x:f.layoutRect().x,y:f.layoutRect().y}},drag:function(h){f.moveTo(g.x+h.deltaX,g.y+h.deltaY)}});f.on("submit",function(h){if(!h.isDefaultPrevented()){f.close()}})},submit:function(){return this.fire("submit",{data:this.toJSON()})},remove:function(){var f=this,g=f.classPrefix;f.dragHelper.destroy();f._super();if(f.statusbar){this.statusbar.remove()}if(f._fullscreen){a.removeClass(document.documentElement,g+"fullscreen");a.removeClass(document.body,g+"fullscreen")}},getContentWindow:function(){var f=this.getEl().getElementsByTagName("iframe")[0];return f?f.contentWindow:null}});return b});