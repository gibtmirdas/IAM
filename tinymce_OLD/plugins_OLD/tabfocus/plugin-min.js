tinymce.PluginManager.add("tabfocus",function(d){var e=tinymce.DOM,f=tinymce.each,c=tinymce.explode;function a(g){if(g.keyCode===9&&!g.ctrlKey&&!g.altKey&&!g.metaKey){g.preventDefault()}}function b(m){var g,k,h,j;if(m.keyCode!==9||m.ctrlKey||m.altKey||m.metaKey){return}function n(q){k=e.select(":input:enabled,*[tabindex]:not(iframe)");function p(r){return r.nodeName==="BODY"||(r.type!="hidden"&&r.style.display!="none"&&r.style.visibility!="hidden"&&p(r.parentNode))}function i(r){return r.tabIndex||r.nodeName=="INPUT"||r.nodeName=="TEXTAREA"}function o(r){return((!i(r)))&&r.getAttribute("tabindex")!="-1"&&p(r)}f(k,function(s,r){if(s.id==d.id){g=r;return false}});if(q>0){for(j=g+1;j<k.length;j++){if(o(k[j])){return k[j]}}}else{for(j=g-1;j>=0;j--){if(o(k[j])){return k[j]}}}return null}h=c(d.getParam("tab_focus",d.getParam("tabfocus_elements",":prev,:next")));if(h.length==1){h[1]=h[0];h[0]=":prev"}if(m.shiftKey){if(h[0]==":prev"){k=n(-1)}else{k=e.get(h[0])}}else{if(h[1]==":next"){k=n(1)}else{k=e.get(h[1])}}if(k){var l=tinymce.get(k.id||k.name);if(k.id&&l){l.focus()}else{window.setTimeout(function(){if(!tinymce.Env.webkit){window.focus()}k.focus()},10)}m.preventDefault()}}d.on("init",function(){if(d.inline){tinymce.DOM.setAttrib(d.getBody(),"tabIndex",null)}});d.on("keyup",a);if(tinymce.Env.gecko){d.on("keypress keydown",b)}else{d.on("keydown",b)}});