tinymce.PluginManager.add("pagebreak",function(f){var b="mce-pagebreak",c=f.getParam("pagebreak_separator","<!-- pagebreak -->"),g=new RegExp(c.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"gi"),d='<img src="'+tinymce.Env.transparentSrc+'" class="'+b+'" data-mce-resize="false" />';f.addCommand("mcePageBreak",function(){f.insertContent(f.settings.pagebreak_split_block?"<p>"+d+"</p>":d)}),f.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),f.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"}),f.on("ResolveName",function(a){"IMG"==a.target.nodeName&&f.dom.hasClass(a.target,b)&&(a.name="pagebreak")}),f.on("click",function(a){a=a.target,"IMG"===a.nodeName&&f.dom.hasClass(a,b)&&f.selection.select(a)}),f.on("BeforeSetContent",function(a){a.content=a.content.replace(g,d)}),f.on("PreInit",function(){f.serializer.addNodeFilter("img",function(e){for(var k,h,j=e.length;j--;){if(k=e[j],h=k.attr("class"),h&&-1!==h.indexOf("mce-pagebreak")){var i=k.parent;if(f.schema.getBlockElements()[i.name]&&f.settings.pagebreak_split_block){i.type=3,i.value=c,i.raw=!0,k.remove();continue}k.type=3,k.value=c,k.raw=!0}}})})});