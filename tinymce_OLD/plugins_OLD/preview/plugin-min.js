tinymce.PluginManager.add("preview",function(b){var a=b.settings;b.addCommand("mcePreview",function(){b.windowManager.open({title:"Preview",width:parseInt(b.getParam("plugin_preview_width","650"),10),height:parseInt(b.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"></iframe>',buttons:{text:"Close",onclick:function(){this.parent().parent().close()}},onPostRender:function(){var h=this.getEl("body").firstChild.contentWindow.document,c,f="";if(b.settings.document_base_url!=b.documentBaseUrl){f+='<base href="'+b.documentBaseURI.getURI()+'">'}tinymce.each(b.contentCSS,function(i){f+='<link type="text/css" rel="stylesheet" href="'+b.documentBaseURI.toAbsolute(i)+'">'});var g=a.body_id||"tinymce";if(g.indexOf("=")!=-1){g=b.getParam("body_id","","hash");g=g[b.id]||g}var e=a.body_class||"";if(e.indexOf("=")!=-1){e=b.getParam("body_class","","hash");e=e[b.id]||""}var d=b.settings.directionality?' dir="'+b.settings.directionality+'"':"";c=("<!DOCTYPE html><html><head>"+f+'</head><body id="'+g+'" class="mce-content-body '+e+'"'+d+">"+b.getContent()+"</body></html>");h.open();h.write(c);h.close()}})});b.addButton("preview",{title:"Preview",cmd:"mcePreview"});b.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})});