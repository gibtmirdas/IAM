define("tinymce/ui/KeyboardNavigation",[],function(){return function(r){var o=r.root,a,h;a=document.activeElement;h=o.getParentCtrl(a);function l(v){v=v||a;return v&&v.getAttribute("role")}function u(x){var w,v=x||a;while((v=v.parentNode)){if((w=l(v))){return w}}}function n(v){var w=a;if(w){return w.getAttribute("aria-"+v)}}function m(w){var v=w.tagName.toUpperCase();return v=="INPUT"||v=="TEXTAREA"}function b(v){if(m(v)&&!v.hidden){return true}if(/^(button|menuitem|checkbox|tab|menuitemcheckbox|option|gridcell)$/.test(l(v))){return true}return false}function g(x){var w=[];function v(z){if(z.nodeType!=1||z.style.display=="none"){return}if(b(z)){w.push(z)}for(var y=0;y<z.childNodes.length;y++){v(z.childNodes[y])}}v(x||o.getEl());return w}function f(y){var w,v;y=y||h;v=y.parents().toArray();v.unshift(y);for(var x=0;x<v.length;x++){w=v[x];if(w.settings.ariaRoot){break}}return w}function p(x){var v=f(x);var w=g(v.getEl());if(v.settings.ariaRemember&&"lastAriaIndex" in v){j(v.lastAriaIndex,w)}else{j(0,w)}}function j(v,w){if(v<0){v=w.length-1}else{if(v>=w.length){v=0}}if(w[v]){w[v].focus()}return v}function t(x,z){var v=-1,w=f();z=z||g(w.getEl());for(var y=0;y<z.length;y++){if(z[y]===a){v=y}}v+=x;w.lastAriaIndex=j(v,z)}function e(){var v=u();if(v=="tablist"){t(-1,g(a.parentNode))}else{if(h.parent().submenu){d()}else{t(-1)}}}function s(){var w=l(),v=u();if(v=="tablist"){t(1,g(a.parentNode))}else{if(w=="menuitem"&&v=="menu"&&n("haspopup")){q()}else{t(1)}}}function i(){t(-1)}function k(){var w=l(),v=u();if(w=="menuitem"&&v=="menubar"){q()}else{if(w=="button"&&n("haspopup")){q({key:"down"})}else{t(1)}}}function c(w){var v=u();if(v=="tablist"){var x=g(h.getEl("body"))[0];if(x){x.focus()}}else{t(w.shiftKey?-1:1)}}function d(){h.fire("cancel")}function q(v){v=v||{};h.fire("click",{target:a,aria:v})}o.on("keydown",function(w){function v(y,x){if(m(a)){return}if(x(y)!==false){y.preventDefault()}}if(w.isDefaultPrevented()){return}switch(w.keyCode){case 37:v(w,e);break;case 39:v(w,s);break;case 38:v(w,i);break;case 40:v(w,k);break;case 27:d();break;case 14:case 13:case 32:v(w,q);break;case 9:if(c(w)!==false){w.preventDefault()}break}});o.on("focusin",function(v){a=v.target;h=v.control});return{focusFirst:p}}});